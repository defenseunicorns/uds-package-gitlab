name: Test package

on:
  # Manual trigger
  workflow_dispatch:

  # Triggered by pull-request-conditionals.yaml
  workflow_call:

# Abort prior jobs in the same workflow / PR
concurrency:
  group: test-${{ github.ref }}-${{ inputs.package }}
  cancel-in-progress: true

permissions:
  contents: read

jobs:
  test:
    uses: defenseunicorns/uds-common/.github/workflows/shared-test-deploy.yaml@17-ewyles-workflow-consolidation
    with:
      flavors: '"upstream", "registry1"'
      runson: '"uds-ubuntu-big-boy-8-core"'
    secrets: inherit
